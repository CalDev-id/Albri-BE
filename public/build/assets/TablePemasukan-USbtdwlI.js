import{q as P,j as t,a as h}from"./app-CxGSB-fu.js";import{d as K}from"./index-DM5UpuYt.js";import{u as k,w as A}from"./xlsx-DjuO7_Ju.js";import{F as D,a as E}from"./index-DeQNj7PW.js";const O=()=>{const{laporanCabang:o,laporanPengeluaranCabang:H,startOfWeek:u,endOfWeek:g,nextWeekOffset:v,prevWeekOffset:_,pakets:c}=P().props,y=e=>{K.Inertia.get(route("admin.laporan.cabang"),{weekOffset:e})},r=e=>typeof e=="number"?e:parseInt(e,10)||0,s=e=>r(e).toLocaleString(),x=e=>o.data.reduce((d,i)=>d+r(i[e]),0),b=(e,d)=>{var m;if(!e.pakets)return 0;const i=e.pakets.find(p=>p.id===d);return i?r((m=i.pivot)==null?void 0:m.jumlah):0},j=e=>o.data.reduce((d,i)=>d+b(i,e),0),C=(e,d)=>{const i=["Hari","Nama","Tanggal","Cabang"],m=c.map(a=>`${a.nama_paket} (${a.harga.toLocaleString()})`),p=["Total Biaya","Daftar","Modul","Kaos","Kas","Lain Lain","Total Pemasukan"],N=[...i,...m,...p],w=e.data.map(a=>{const l={Hari:a.hari,Nama:a.user?a.user.name:"N/A",Tanggal:a.tanggal,Cabang:a.cabang?a.cabang.nama:"N/A"};return c.forEach(f=>{const $=`${f.nama_paket} (${f.harga.toLocaleString()})`;l[$]=b(a,f.id)}),l["Total Biaya"]=r(a.totalbiaya),l.Daftar=r(a.daftar),l.Modul=r(a.modul),l.Kaos=r(a.kaos),l.Kas=r(a.kas),l["Lain Lain"]=r(a.lainlain),l["Total Pemasukan"]=r(a.totalpemasukan),l}),n={Hari:"Total",Nama:"",Tanggal:"",Cabang:""};c.forEach(a=>{const l=`${a.nama_paket} (${a.harga.toLocaleString()})`;n[l]=j(a.id)}),n["Total Biaya"]=x("totalbiaya"),n.Daftar=x("daftar"),n.Modul=x("modul"),n.Kaos=x("kaos"),n.Kas=x("kas"),n["Lain Lain"]=x("lainlain"),n["Total Pemasukan"]=x("totalpemasukan"),w.push(n);const T=k.json_to_sheet(w,{header:N});k.sheet_add_aoa(T,[N],{origin:"A1"});const L=k.book_new();k.book_append_sheet(L,T,"Laporan");const S=`Laporan_Pemasukan_cabang_${d}.xlsx`;A(L,S)};return t.jsx("div",{children:t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsxs("h4",{className:"text-xl font-semibold text-black dark:text-white",children:["Laporan Pemasukan Cabang (",u," sampai ",g,")"]}),t.jsxs("div",{children:[t.jsx(h,{href:"/admin/laporan/cabang/create",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90",children:"Tambah Laporan"})}),t.jsx("button",{onClick:()=>C(o,`${u} sampai ${g}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"}),t.jsx(h,{href:"/admin/laporan/cabang/paket/",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90 ml-2",children:"Setting Harga"})})]})]}),t.jsxs("div",{className:"overflow-x-auto",children:[t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Nama"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Cabang"}),c.map(e=>t.jsxs("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:[e.nama_paket," (",e.harga.toLocaleString(),")"]},e.id)),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total Biaya"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Daftar"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Modul"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kaos"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kas"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:o.data.map(e=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.cabang?e.cabang.nama:"N/A"}),c.map(d=>t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:b(e,d.id)},d.id)),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:s(e.totalbiaya)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:s(e.daftar)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:s(e.modul)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:s(e.kaos)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:s(e.kas)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:s(e.lainlain)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:s(e.totalpemasukan)}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(h,{href:`/admin/laporan/cabang/${e.id}/edit`,children:t.jsx(D,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(h,{href:`/admin/laporan/cabang/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:d=>{confirm("Yakin hapus laporan ini?")||d.preventDefault()},children:t.jsx(E,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},e.id))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{colSpan:4,className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),c.map(e=>t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:j(e.id)},e.id)),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s(x("totalbiaya"))}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s(x("daftar"))}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s(x("modul"))}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s(x("kaos"))}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s(x("kas"))}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s(x("lainlain"))}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s(x("totalpemasukan"))}),t.jsx("td",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white"})]})})]}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>y(_),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>y(v),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})]})})};export{O as default};
