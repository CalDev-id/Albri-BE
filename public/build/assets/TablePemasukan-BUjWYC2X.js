import{q as H,j as t,a as p}from"./app-Pk8tfygK.js";import{u as b,w as P}from"./xlsx-DjuO7_Ju.js";import"./flowbite.min-Dyi2Wf9s.js";import{F as E,a as B}from"./index-lOJScoDl.js";import{d as W}from"./index-BPTtt6RU.js";const M=()=>{const{laporanMitra:k,startOfWeek:u,endOfWeek:f,nextWeekOffset:S,prevWeekOffset:T,paketMitra:d}=H().props,y=e=>{W.Inertia.get(route("admin.laporan.mitra"),{weekOffset:e})},x=e=>k.data.reduce((i,l)=>i+(l[e]||0),0),v=e=>k.data.reduce((i,l)=>{var c,o;const r=(c=l.pakets)==null?void 0:c.find(n=>n.id===e);return i+(((o=r==null?void 0:r.pivot)==null?void 0:o.jumlah)||0)},0),_=(e,i)=>{const l=e.data.map(a=>{const s={Hari:a.hari,Tanggal:a.tanggal};return d==null||d.forEach(m=>{var w,L;const h=(w=a.pakets)==null?void 0:w.find($=>$.id===m.id);s[`${m.nama_paket} (${m.harga.toLocaleString()})`]=((L=h==null?void 0:h.pivot)==null?void 0:L.jumlah)||0}),s["Total Biaya"]=a.totalbiaya||0,s.Daftar=a.daftar||0,s.Modul=a.modul||0,s.Kaos=a.kaos||0,s.Kas=a.kas||0,s["Lain Lain"]=a.lainlain||0,s["Total Pemasukan"]=a.totalpemasukan||0,s}),r={Hari:"Total",Tanggal:""};d==null||d.forEach(a=>{const s=`${a.nama_paket} (${a.harga.toLocaleString()})`;r[s]=l.reduce((m,h)=>m+(h[s]||0),0)}),r["Total Biaya"]=l.reduce((a,s)=>a+(s["Total Biaya"]||0),0),r.Daftar=l.reduce((a,s)=>a+(s.Daftar||0),0),r.Modul=l.reduce((a,s)=>a+(s.Modul||0),0),r.Kaos=l.reduce((a,s)=>a+(s.Kaos||0),0),r.Kas=l.reduce((a,s)=>a+(s.Kas||0),0),r["Lain Lain"]=l.reduce((a,s)=>a+(s["Lain Lain"]||0),0),r["Total Pemasukan"]=l.reduce((a,s)=>a+(s["Total Pemasukan"]||0),0),l.push(r);const c=["Hari","Tanggal"],o=(d==null?void 0:d.map(a=>`${a.nama_paket} (${a.harga.toLocaleString()})`))||[],n=["Total Biaya","Daftar","Modul","Kaos","Kas","Lain Lain","Total Pemasukan"],g=[...c,...o,...n],j=b.json_to_sheet(l,{header:g});b.sheet_add_aoa(j,[g],{origin:"A1"});const N=b.book_new();b.book_append_sheet(N,j,"Laporan");const K=`Laporan_Pemasukan_mitra_${i}.xlsx`;P(N,K)};return t.jsx("div",{children:t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsxs("h4",{className:"text-xl font-semibold text-black dark:text-white",children:["Laporan Pemasukan Mitra ( ",u," sampai"," ",f," )"]}),t.jsxs("div",{children:[t.jsx(p,{href:"/admin/laporan/mitra/create",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90",children:"Tambah Laporan"})}),t.jsx("button",{onClick:()=>_(k,`${u} sampai ${f}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"}),t.jsx(p,{href:"/admin/laporan/mitra/setting-harga",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90 ml-2 ",children:"Setting Harga"})})]})]}),t.jsxs("div",{className:"overflow-x-auto",children:[t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Nama"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),d&&d.map(e=>t.jsxs("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:[e.nama_paket," (",e.harga.toLocaleString(),")"]},e.id)),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total Biaya"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Daftar"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Modul"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kaos"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kas"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:k.data.map((e,i)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),d&&d.map(l=>{var c,o;const r=(c=e.pakets)==null?void 0:c.find(n=>n.id===l.id);return t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:((o=r==null?void 0:r.pivot)==null?void 0:o.jumlah)||0},l.id)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.totalbiaya.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.daftar.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.modul.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.kaos.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.kas.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.lainlain.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.totalpemasukan.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(p,{href:`/admin/laporan/mitra/${e.id}/edit`,children:t.jsx(E,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(p,{href:`/admin/laporan/mitra/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:l=>{confirm("Are you sure you want to delete this user?")||l.preventDefault()},children:t.jsx(B,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},i))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{colSpan:"3",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),d&&d.map(e=>t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:v(e.id)},e.id)),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:x("totalbiaya").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:x("daftar").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:x("modul").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:x("kaos").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:x("kas").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:x("lainlain").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:x("totalpemasukan").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white"})]})})]}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>y(T),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>y(S),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})]})})};export{M as default};
