import{q as P,j as t,a as d}from"./app-BqKozNyH.js";import{F as _,a as M}from"./index-DjpOq2Q6.js";import{d as k}from"./index-BHF4FRS3.js";import{u as m,w as C}from"./xlsx-DjuO7_Ju.js";const W=({selectedIds:l=[],setSelectedIds:x=()=>{}})=>{const{laporanPengeluaranMitra:n,startOfWeek:u,endOfWeek:N,nextWeekOffset:j,prevWeekOffset:f}=P().props,o=e=>{k.Inertia.get(route("admin.laporan.mitra"),{weekOffset:e})},y=e=>{if(e.target.checked){const r=n.data.map(s=>s.id);x(r)}else x([])},g=e=>{l.includes(e)?x(l.filter(r=>r!==e)):x([...l,e])},w=()=>{if(l.length===0){alert("Pilih item yang akan dihapus");return}confirm(`Apakah Anda yakin ingin menghapus ${l.length} item?`)&&k.Inertia.post(route("admin.laporan.pengeluaranmitra.bulk-destroy"),{ids:l},{onSuccess:()=>{x([])}})},c=e=>n.data.reduce((r,s)=>r+(Number(s[e])||0),0),L=e=>!e.mitras||e.mitras.length===0?0:e.mitras.reduce((r,s)=>r+(Number(s.gaji)||0),0),T=e=>!e.mitras||e.mitras.length===0?"N/A":e.mitras.map(r=>r.mitra_nama).join(", "),v=(e,r)=>{const s=e.data.map(a=>({Hari:a.hari,Tanggal:a.tanggal,Pembuat:a.user?a.user.name:"N/A","Nama Mitra":T(a),Gaji:L(a),ATK:Number(a.atk)||0,Intensif:Number(a.intensif)||0,Lisensi:Number(a.lisensi)||0,"Lain Lain":Number(a.lainlain)||0,Total:Number(a.totalpengeluaran)||0})),A={Hari:"Total",Tanggal:"",Pembuat:"","Nama Mitra":"",Gaji:s.reduce((a,i)=>a+Number(i.Gaji),0),ATK:s.reduce((a,i)=>a+Number(i.ATK),0),Intensif:s.reduce((a,i)=>a+Number(i.Intensif),0),Lisensi:s.reduce((a,i)=>a+Number(i.Lisensi),0),"Lain Lain":s.reduce((a,i)=>a+Number(i["Lain Lain"]),0),Total:s.reduce((a,i)=>a+Number(i.Total),0)};s.push(A);const h=["Hari","Tanggal","Pembuat","Nama Mitra","Gaji","ATK","Intensif","Lisensi","Lain Lain","Total"],b=m.json_to_sheet(s,{header:h});m.sheet_add_aoa(b,[h],{origin:"A1"});const p=m.book_new();m.book_append_sheet(p,b,"Pengeluaran");const S=`Laporan_Pengeluaran_Mitra_${r}.xlsx`;C(p,S)};return t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark mt-20",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsx("h4",{className:"text-xl font-semibold text-black dark:text-white",children:"Laporan Pengeluaran Mitra"}),t.jsxs("div",{children:[t.jsx(d,{href:"/admin/laporan/pengeluaranmitra/create",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90",children:"Tambah Pengeluaran"})}),t.jsx("button",{onClick:()=>v(n,`${u} sampai ${N}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"}),l.length>0&&t.jsxs("button",{onClick:w,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 ml-2",children:["Hapus Terpilih (",l.length,")"]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-center",children:t.jsx("input",{type:"checkbox",onChange:y,checked:n.data.length>0&&l.length===n.data.length,className:"w-4 h-4"})}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Pembuat"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Gaji"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"ATK"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Intensif"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lisensi"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:n.data.map((e,r)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsx("input",{type:"checkbox",checked:l.includes(e.id),onChange:()=>g(e.id),className:"w-4 h-4"})}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.mitras&&e.mitras.length>0?e.mitras.map(s=>t.jsxs("div",{children:[s.mitra_nama," - Rp ",Number(s.gaji).toLocaleString()]},s.id)):"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:(Number(e.atk)||0).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:(Number(e.intensif)||0).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:(Number(e.lisensi)||0).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:(Number(e.lainlain)||0).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:(Number(e.totalpengeluaran)||0).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(d,{href:`/admin/laporan/pengeluaranmitra/${e.id}/edit`,children:t.jsx(_,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(d,{href:`/admin/laporan/pengeluaranmitra/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:s=>{confirm("Are you sure you want to delete this item?")||s.preventDefault()},children:t.jsx(M,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},r))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{className:"py-4 px-4 text-center"}),t.jsx("td",{colSpan:"4",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:c("atk").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:c("intensif").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:c("lisensi").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:c("lainlain").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:c("totalpengeluaran").toLocaleString()}),t.jsx("td",{className:"py-4 px-4"})]})})]})}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>o(f),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>o(j),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})};export{W as default};
