import{q as D,j as t,a as k}from"./app-BqKozNyH.js";import{u as g,w as W}from"./xlsx-DjuO7_Ju.js";import"./flowbite.min-Dyi2Wf9s.js";import{F,a as O}from"./index-DjpOq2Q6.js";import{d as v}from"./index-BHF4FRS3.js";const J=({selectedIds:n=[],setSelectedIds:h=()=>{}})=>{const{laporanMitra:d,startOfWeek:f,endOfWeek:N,nextWeekOffset:_,prevWeekOffset:$,paketMitra:i}=D().props,y=e=>{v.Inertia.get(route("admin.laporan.mitra"),{weekOffset:e})},K=e=>{if(e.target.checked){const x=d.data.map(r=>r.id);h(x)}else h([])},H=e=>{n.includes(e)?h(n.filter(x=>x!==e)):h([...n,e])},P=()=>{if(n.length===0){alert("Pilih item yang akan dihapus");return}confirm(`Apakah Anda yakin ingin menghapus ${n.length} item?`)&&v.Inertia.post(route("admin.laporan.mitra.bulk-destroy"),{ids:n},{onSuccess:()=>{h([])}})},c=e=>d.data.reduce((x,r)=>x+(Number(r[e])||0),0),A=e=>d.data.reduce((x,r)=>{var o,m;const l=(o=r.pakets)==null?void 0:o.find(u=>u.id===e);return x+(Number((m=l==null?void 0:l.pivot)==null?void 0:m.jumlah)||0)},0),C=(e,x)=>{const r=e.data.map(a=>{const s={Hari:a.hari,Tanggal:a.tanggal};return i==null||i.forEach(b=>{var T,S;const p=(T=a.pakets)==null?void 0:T.find(E=>E.id===b.id);s[`${b.nama_paket} (${b.harga.toLocaleString()})`]=((S=p==null?void 0:p.pivot)==null?void 0:S.jumlah)||0}),s["Total Biaya"]=Number(a.totalbiaya)||0,s.Daftar=Number(a.daftar)||0,s.Modul=Number(a.modul)||0,s.Kaos=Number(a.kaos)||0,s.Kas=Number(a.kas)||0,s["Lain Lain"]=Number(a.lainlain)||0,s["Total Pemasukan"]=Number(a.totalpemasukan)||0,s}),l={Hari:"Total",Tanggal:""};i==null||i.forEach(a=>{const s=`${a.nama_paket} (${a.harga.toLocaleString()})`;l[s]=r.reduce((b,p)=>b+(Number(p[s])||0),0)}),l["Total Biaya"]=r.reduce((a,s)=>a+(Number(s["Total Biaya"])||0),0),l.Daftar=r.reduce((a,s)=>a+(Number(s.Daftar)||0),0),l.Modul=r.reduce((a,s)=>a+(Number(s.Modul)||0),0),l.Kaos=r.reduce((a,s)=>a+(Number(s.Kaos)||0),0),l.Kas=r.reduce((a,s)=>a+(Number(s.Kas)||0),0),l["Lain Lain"]=r.reduce((a,s)=>a+(Number(s["Lain Lain"])||0),0),l["Total Pemasukan"]=r.reduce((a,s)=>a+(Number(s["Total Pemasukan"])||0),0),r.push(l);const o=["Hari","Tanggal"],m=(i==null?void 0:i.map(a=>`${a.nama_paket} (${a.harga.toLocaleString()})`))||[],u=["Total Biaya","Daftar","Modul","Kaos","Kas","Lain Lain","Total Pemasukan"],j=[...o,...m,...u],w=g.json_to_sheet(r,{header:j});g.sheet_add_aoa(w,[j],{origin:"A1"});const L=g.book_new();g.book_append_sheet(L,w,"Laporan");const B=`Laporan_Pemasukan_mitra_${x}.xlsx`;W(L,B)};return t.jsx("div",{children:t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsxs("h4",{className:"text-xl font-semibold text-black dark:text-white",children:["Laporan Pemasukan Mitra ( ",f," sampai"," ",N," )"]}),t.jsxs("div",{children:[t.jsx(k,{href:"/admin/laporan/mitra/create",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90",children:"Tambah Laporan"})}),t.jsx("button",{onClick:()=>C(d,`${f} sampai ${N}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"}),n.length>0&&t.jsxs("button",{onClick:P,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 ml-2",children:["Hapus Terpilih (",n.length,")"]}),t.jsx(k,{href:"/admin/laporan/mitra/setting-harga",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90 ml-2 ",children:"Setting Harga"})})]})]}),t.jsxs("div",{className:"overflow-x-auto",children:[t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-center",children:t.jsx("input",{type:"checkbox",onChange:K,checked:d.data.length>0&&n.length===d.data.length,className:"w-4 h-4"})}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Nama"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),i&&i.map(e=>t.jsxs("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:[e.nama_paket," (",e.harga.toLocaleString(),")"]},e.id)),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total Biaya"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Daftar"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Modul"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kaos"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kas"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:d.data.map((e,x)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsx("input",{type:"checkbox",checked:n.includes(e.id),onChange:()=>H(e.id),className:"w-4 h-4"})}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),i&&i.map(r=>{var o,m;const l=(o=e.pakets)==null?void 0:o.find(u=>u.id===r.id);return t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:((m=l==null?void 0:l.pivot)==null?void 0:m.jumlah)||0},r.id)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.totalbiaya).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.daftar).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.modul).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.kaos).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.kas).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.lainlain).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.totalpemasukan).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(k,{href:`/admin/laporan/mitra/${e.id}/edit`,children:t.jsx(F,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(k,{href:`/admin/laporan/mitra/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:r=>{confirm("Are you sure you want to delete this item?")||r.preventDefault()},children:t.jsx(O,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},x))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{className:"py-4 px-4 text-center"}),t.jsx("td",{colSpan:"3",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),i&&i.map(e=>t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:A(e.id)},e.id)),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:c("totalbiaya").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:c("daftar").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:c("modul").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:c("kaos").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:c("kas").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:c("lainlain").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:c("totalpemasukan").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white"})]})})]}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>y($),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>y(_),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})]})})};export{J as default};
