import{q as I,r as g,U as _,j as t,a as y}from"./app-DYDPL5Ve.js";import{u as h,w as D}from"./xlsx-DjuO7_Ju.js";import{S as n}from"./sweetalert2.esm.all-5zhdP7Ax.js";import"./flowbite.min-Dyi2Wf9s.js";import{F as H,a as F}from"./index-C241Ir5o.js";import{d as w}from"./index-Wnk5kL6P.js";const U=()=>{const{laporanPengeluaranMitra:l,bulan:p,tahun:k,nextMonth:N,nextYear:S,prevMonth:L,prevYear:v}=I().props,[i,x]=g.useState([]),[c,o]=g.useState(!1),b=(e,s)=>{w.Inertia.get(route("admin.rekap.mitra"),{bulan:e,tahun:s})},d=e=>((l==null?void 0:l.data)||[]).reduce((s,a)=>e==="gaji"?a.mitras&&a.mitras.length>0?s+a.mitras.reduce((u,m)=>u+(m.gaji||0),0):s+(a.gaji||0):s+(a[e]||0),0),T=(e,s)=>{const a=(e==null?void 0:e.data)||[];if(a.length===0){alert("Tidak ada data untuk di-download");return}const m=[["No","Hari","Tanggal","Nama","ATK","Intensif","Lisensi","Lain-lain","Total Pengeluaran"],...a.map((r,E)=>{var j;return[E+1,r.hari,r.tanggal,((j=r.user)==null?void 0:j.name)||"N/A",r.atk||0,r.intensif||0,r.lisensi||0,r.lainlain||0,r.totalpengeluaran||0]})],$=h.aoa_to_sheet(m),f=h.book_new();h.book_append_sheet(f,$,"Laporan Pengeluaran"),D(f,`${s}.xlsx`)},C=e=>{x(s=>s.includes(e)?s.filter(a=>a!==e):[...s,e])},B=()=>{x(c?[]:l.data.map(e=>e.id)),o(!c)},A=()=>{if(i.length===0){n.fire({icon:"warning",title:"Pilih Data",text:"Pilih item yang ingin dihapus terlebih dahulu",confirmButtonColor:"#3085d6"});return}n.fire({title:"Konfirmasi Hapus",text:`Yakin ingin menghapus ${i.length} item yang dipilih?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"}).then(e=>{if(e.isConfirmed){const s=i.length;w.Inertia.post("/admin/laporan/pengeluaranmitra/bulk-delete",{ids:i},{preserveScroll:!0,onStart:()=>{x([]),o(!1)},onSuccess:()=>{n.fire({icon:"success",title:"Berhasil!",text:`${s} item berhasil dihapus`,confirmButtonColor:"#3085d6",timer:2e3,timerProgressBar:!0})},onError:()=>{n.fire({icon:"error",title:"Gagal!",text:"Terjadi kesalahan saat menghapus data",confirmButtonColor:"#3085d6"})}})}})};return _.useEffect(()=>{o(i.length===l.data.length&&l.data.length>0)},[i,l.data]),t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark mt-20",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsxs("h4",{className:"text-xl font-semibold text-black dark:text-white",children:["Rekap Pengeluaran Mitra - ",p,"/",k]}),t.jsxs("div",{children:[t.jsx("button",{onClick:()=>T(l,`${p} sampai ${k}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"}),i.length>0&&t.jsxs("button",{onClick:A,className:"bg-red-500 text-white px-4 py-2 rounded ml-2 hover:bg-red-600",children:["Hapus Terpilih (",i.length,")"]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:t.jsx("input",{type:"checkbox",checked:c,onChange:B,className:"rounded border-gray-300"})}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Pembuat"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Gaji"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"ATK"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Intensif"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lisensi"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4",children:" Aksi "})]})}),t.jsx("tbody",{children:((l==null?void 0:l.data)||[]).map((e,s)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:t.jsx("input",{type:"checkbox",checked:i.includes(e.id),onChange:()=>C(e.id),className:"rounded border-gray-300"})}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.mitras&&e.mitras.length>0?e.mitras.map(a=>t.jsxs("div",{children:[a.mitra_nama," - Rp ",(a.gaji||0).toLocaleString()]},a.id)):`Rp ${(e.gaji||0).toLocaleString()}`}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.atk.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.intensif.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.lisensi.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.lainlain.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.totalpengeluaran.toLocaleString()}),t.jsx("td",{className:"py-4 px-4",children:t.jsxs("div",{className:"flex flex-row items-center justify-center gap-3 h-full",children:[t.jsx(y,{href:`/admin/laporan/pengeluaranmitra/${e.id}/edit`,children:t.jsx(H,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(y,{href:`/admin/laporan/pengeluaranmitra/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:a=>{confirm("Are you sure you want to delete this item?")||a.preventDefault()},children:t.jsx(F,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},s))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{colSpan:"4",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:d("gaji").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:d("atk").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:d("intensif").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:d("lisensi").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:d("lainlain").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:d("totalpengeluaran").toLocaleString()}),t.jsx("td",{className:"py-4 px-4"})]})})]})}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>b(L,v),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>b(N,S),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})};export{U as default};
