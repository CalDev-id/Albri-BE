import{j as t,a as m}from"./app-CDoVCI0C.js";import{F as f,a as w}from"./index-CsnNzEpE.js";import"./index-DGlSFbZT.js";import{u as x,w as g}from"./xlsx-DjuO7_Ju.js";const _=({laporanPengeluaranPrivate:d,startOfWeek:p,endOfWeek:k,nextWeekOffset:N,prevWeekOffset:j,goToWeek:n})=>{const r=a=>d.data.reduce((l,s)=>l+(Number(s[a])||0),0),u=(a,l)=>{const s=a.data.map(e=>({Hari:e.hari,Tanggal:e.tanggal,Pembuat:e.user?e.user.name:"N/A","Nama Private":e.private_bimbles&&e.private_bimbles.length>0?e.private_bimbles.map(i=>i.name).join(", "):"N/A",Gaji:Number(e.gaji)||0,ATK:Number(e.atk)||0,Intensif:Number(e.intensif)||0,Lisensi:Number(e.lisensi)||0,"Lain Lain":Number(e.lainlain)||0,Total:Number(e.totalpengeluaran)||0})),c={Hari:"Total",Tanggal:"",Pembuat:"","Nama Private":"",Gaji:s.reduce((e,i)=>e+Number(i.Gaji),0),ATK:s.reduce((e,i)=>e+Number(i.ATK),0),Intensif:s.reduce((e,i)=>e+Number(i.Intensif),0),Lisensi:s.reduce((e,i)=>e+Number(i.Lisensi),0),"Lain Lain":s.reduce((e,i)=>e+Number(i["Lain Lain"]),0),Total:s.reduce((e,i)=>e+Number(i.Total),0)};s.push(c);const o=["Hari","Tanggal","Pembuat","Nama Private","Gaji","ATK","Intensif","Lisensi","Lain Lain","Total"],h=x.json_to_sheet(s,{header:o});x.sheet_add_aoa(h,[o],{origin:"A1"});const b=x.book_new();x.book_append_sheet(b,h,"Pengeluaran");const y=`Laporan_Pengeluaran_Private_${l}.xlsx`;g(b,y)};return t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark mt-20",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsx("h4",{className:"text-xl font-semibold text-black dark:text-white",children:"Laporan Pengeluaran Private"}),t.jsxs("div",{children:[t.jsx(m,{href:"/admin/laporan/pengeluaranprivate/create",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90",children:"Tambah Pengeluaran"})}),t.jsx("button",{onClick:()=>u(d,`${p} sampai ${k}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Pembuat"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Gaji"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"ATK"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Intensif"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lisensi"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:d.data.map((a,l)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:a.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.tanggal}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.user?a.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.gurus&&a.gurus.length>0?a.gurus.map((s,c)=>t.jsxs("div",{children:[s.guru_id," - Rp ",Number(s.gaji).toLocaleString()]},c)):`Rp ${Number(a.gaji).toLocaleString()}`}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(a.atk).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(a.intensif).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(a.lisensi).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(a.lainlain).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(a.totalpengeluaran).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(m,{href:`/admin/laporan/pengeluaranprivate/${a.id}/edit`,children:t.jsx(f,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(m,{href:`/admin/laporan/pengeluaranprivate/${a.id}`,method:"delete",as:"button",data:{id:a.id},onClick:s=>{confirm("Are you sure you want to delete this item?")||s.preventDefault()},children:t.jsx(w,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},l))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{colSpan:"3",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:r("gaji").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:r("atk").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:r("intensif").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:r("lisensi").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:r("lainlain").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:r("totalpengeluaran").toLocaleString()}),t.jsx("td",{className:"py-4 px-4"})]})})]})}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>n(j),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>n(N),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})};export{_ as default};
