import{q as C,j as t,a as k}from"./app-CDoVCI0C.js";import{d as $}from"./index-DGlSFbZT.js";import{u as o,w as P}from"./xlsx-DjuO7_Ju.js";import{F as K,a as A}from"./index-CsnNzEpE.js";const H=()=>{const{laporanCabang:i,laporanPengeluaranCabang:D,startOfWeek:p,endOfWeek:u,nextWeekOffset:L,prevWeekOffset:S,pakets:n}=C().props,N=e=>{$.Inertia.get(route("admin.laporan.cabang"),{weekOffset:e})},s=e=>i.data.reduce((r,d)=>r+Number(d[e]),0),m=(e,r)=>{var c;if(!e.pakets)return 0;const d=e.pakets.find(h=>h.id===r);return d?Number((c=d.pivot)==null?void 0:c.jumlah):0},g=e=>i.data.reduce((r,d)=>r+m(d,e),0),T=(e,r)=>{const d=["Hari","Nama","Tanggal","Cabang"],c=n.map(a=>`${a.nama_paket} (${a.harga.toLocaleString()})`),h=["Total Biaya","Daftar","Modul","Kaos","Kas","Lain Lain","Total Pemasukan"],f=[...d,...c,...h],y=e.data.map(a=>{const l={Hari:a.hari,Nama:a.user?a.user.name:"N/A",Tanggal:a.tanggal,Cabang:a.cabang?a.cabang.nama:"N/A"};return n.forEach(b=>{const _=`${b.nama_paket} (${b.harga.toLocaleString()})`;l[_]=m(a,b.id)}),l["Total Biaya"]=Number(a.totalbiaya),l.Daftar=Number(a.daftar),l.Modul=Number(a.modul),l.Kaos=Number(a.kaos),l.Kas=Number(a.kas),l["Lain Lain"]=Number(a.lainlain),l["Total Pemasukan"]=Number(a.totalpemasukan),l}),x={Hari:"Total",Nama:"",Tanggal:"",Cabang:""};n.forEach(a=>{const l=`${a.nama_paket} (${a.harga.toLocaleString()})`;x[l]=g(a.id)}),x["Total Biaya"]=s("totalbiaya"),x.Daftar=s("daftar"),x.Modul=s("modul"),x.Kaos=s("kaos"),x.Kas=s("kas"),x["Lain Lain"]=s("lainlain"),x["Total Pemasukan"]=s("totalpemasukan"),y.push(x);const j=o.json_to_sheet(y,{header:f});o.sheet_add_aoa(j,[f],{origin:"A1"});const w=o.book_new();o.book_append_sheet(w,j,"Laporan");const v=`Laporan_Pemasukan_cabang_${r}.xlsx`;P(w,v)};return t.jsx("div",{children:t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsxs("h4",{className:"text-xl font-semibold text-black dark:text-white",children:["Laporan Pemasukan Cabang (",p," sampai ",u,")"]}),t.jsxs("div",{children:[t.jsx(k,{href:"/admin/laporan/cabang/create",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90",children:"Tambah Laporan"})}),t.jsx("button",{onClick:()=>T(i,`${p} sampai ${u}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"})]})]}),t.jsxs("div",{className:"overflow-x-auto",children:[t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Nama"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Cabang"}),n.map(e=>t.jsxs("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:[e.nama_paket," (",e.harga.toLocaleString(),")"]},e.id)),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total Biaya"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Daftar"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Modul"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kaos"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kas"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:i.data.map(e=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.cabang?e.cabang.nama:"N/A"}),n.map(r=>t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:m(e,r.id)},r.id)),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.totalbiaya).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.daftar).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.modul).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.kaos).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.kas).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.lainlain).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.totalpemasukan).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(k,{href:`/admin/laporan/cabang/${e.id}/edit`,children:t.jsx(K,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(k,{href:`/admin/laporan/cabang/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:r=>{confirm("Yakin hapus laporan ini?")||r.preventDefault()},children:t.jsx(A,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},e.id))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{colSpan:4,className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),n.map(e=>t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:g(e.id)},e.id)),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:Number(s("totalbiaya")).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:Number(s("daftar")).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:Number(s("modul")).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:Number(s("kaos")).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:Number(s("kas")).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:Number(s("lainlain")).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:Number(s("totalpemasukan")).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white"})]})})]}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>N(S),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>N(L),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})]})})};export{H as default};
