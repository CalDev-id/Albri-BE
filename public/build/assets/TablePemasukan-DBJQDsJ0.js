import{q as v,j as t,a as h}from"./app-DkQQNQ4T.js";import{u as k,w as T}from"./xlsx-DjuO7_Ju.js";import"./flowbite.min-Dyi2Wf9s.js";import{F as _,a as M}from"./index-CNG7MX43.js";import{d as D}from"./index-BhwYw7oT.js";const K=()=>{const{laporanMitra:o,startOfWeek:p,endOfWeek:b,nextWeekOffset:y,prevWeekOffset:g,paketMitra:i}=v().props,u=e=>{D.Inertia.get(route("Mitra.index"),{weekOffset:e})},s=e=>o.data.reduce((r,x)=>r+(Number(x[e])||0),0),f=e=>o.data.reduce((r,x)=>{var d;const c=(x.pakets||[]).find(a=>a.id===e);return r+(c&&((d=c.pivot)==null?void 0:d.jumlah)||0)},0),w=()=>{const e=k.book_new(),r=["Hari","Nama","Tanggal",...(i||[]).map(a=>a.nama_paket),"Total Biaya","Daftar","Modul","Kaos","Kas","Lain Lain","Total"],x=o.data.map(a=>{const m=[a.hari,a.user?a.user.name:"N/A",a.tanggal];return(i||[]).forEach(L=>{var N,j;const n=(N=a.pakets)==null?void 0:N.find(S=>S.id===L.id);m.push(((j=n==null?void 0:n.pivot)==null?void 0:j.jumlah)||0)}),m.push(Number(a.totalbiaya),Number(a.daftar),Number(a.modul),Number(a.kaos),Number(a.kas),Number(a.lainlain),Number(a.totalpemasukan)),m}),l=["Total","",""];(i||[]).forEach(a=>{l.push(f(a.id))}),l.push(s("totalbiaya"),s("daftar"),s("modul"),s("kaos"),s("kas"),s("lainlain"),s("totalpemasukan"));const c=[r,...x,l],d=k.aoa_to_sheet(c);k.book_append_sheet(e,d,"Pemasukan Mitra"),T(e,`Laporan_Mitra_${p}_to_${b}.xlsx`)};return t.jsx("div",{children:t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsxs("h4",{className:"text-xl font-semibold text-black dark:text-white",children:["Laporan Pemasukan Mitra ( ",p," sampai"," ",b," )"]}),t.jsxs("div",{children:[t.jsx(h,{href:"/admin/laporan/mitra/create",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90",children:"Tambah Laporan"})}),t.jsx("button",{onClick:()=>w(),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"})]})]}),t.jsxs("div",{className:"overflow-x-auto",children:[t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Nama"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),(i||[]).map(e=>t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:e.nama_paket},e.id)),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total Biaya"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Daftar"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Modul"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kaos"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Kas"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:o.data.map((e,r)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),(i||[]).map(x=>{var d,a;const l=(d=e.pakets)==null?void 0:d.find(m=>m.id===x.id),c=((a=l==null?void 0:l.pivot)==null?void 0:a.jumlah)||0;return t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(c).toLocaleString()},x.id)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.totalbiaya).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.daftar).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.modul).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.kaos).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.kas).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.lainlain).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:Number(e.totalpemasukan).toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(h,{href:`/admin/laporan/mitra/${e.id}/edit`,children:t.jsx(_,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(h,{href:`/admin/laporan/mitra/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:x=>{confirm("Are you sure you want to delete this user?")||x.preventDefault()},children:t.jsx(M,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},r))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{colSpan:"3",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),(i||[]).map(e=>t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:f(e.id).toLocaleString()},e.id)),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s("totalbiaya").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s("daftar").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s("modul").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s("kaos").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s("kas").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s("lainlain").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm font-bold text-black dark:text-white",children:s("totalpemasukan").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white"})]})})]}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>u(g),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>u(y),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})]})})};export{K as default};
