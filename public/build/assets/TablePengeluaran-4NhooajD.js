import{q as T,j as t,a as h}from"./app-N1DU8MBc.js";import{F as A,a as v}from"./index-P9s4Df2-.js";import{d as L}from"./index-DxUZZfL0.js";import{u as o,w as C}from"./xlsx-DjuO7_Ju.js";const G=()=>{const{laporanPengeluaranCabang:d,startOfWeek:p,endOfWeek:j,nextWeekOffset:y,prevWeekOffset:f}=T().props,k=e=>{L.Inertia.get(route("admin.laporan.cabang"),{weekOffset:e})},r=e=>typeof e=="number"?e:parseInt(e,10)||0,x=e=>r(e).toLocaleString(),s=e=>d.data.reduce((l,i)=>e==="gaji"?i.gurus&&Array.isArray(i.gurus)&&i.gurus.length>0?l+i.gurus.reduce((c,m)=>c+r(m.gaji),0):l+r(i.gaji):l+r(i[e]),0),N=(e,l)=>{const i=e.data.map(a=>{let n=0;return a.gurus&&Array.isArray(a.gurus)&&a.gurus.length>0?n=a.gurus.reduce((u,g)=>u+r(g.gaji),0):n=r(a.gaji),{Hari:a.hari||"",Tanggal:a.tanggal||"",Cabang:a.cabang?a.cabang.nama:"N/A","Nama Guru":a.user?a.user.name:"N/A",Gaji:n,ATK:r(a.atk),Sewa:r(a.sewa),Intensif:r(a.intensif),Lisensi:r(a.lisensi),THR:r(a.thr),"Lain Lain":r(a.lainlain),Total:r(a.totalpengeluaran)}}),c={Hari:"Total",Tanggal:"",Cabang:"","Nama Guru":"",Gaji:s("gaji"),ATK:s("atk"),Sewa:s("sewa"),Intensif:s("intensif"),Lisensi:s("lisensi"),THR:s("thr"),"Lain Lain":s("lainlain"),Total:s("totalpengeluaran")};i.push(c);const m=o.json_to_sheet(i),b=o.book_new();o.book_append_sheet(b,m,"Pengeluaran");const w=`Laporan_Pengeluaran_cabang_${l}.xlsx`;C(b,w)};return t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark mt-20",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsx("h4",{className:"text-xl font-semibold text-black dark:text-white",children:"Laporan Pengeluaran Cabang"}),t.jsxs("div",{children:[t.jsx(h,{href:"/admin/laporan/pengeluaran/create",children:t.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90",children:"Tambah Pengeluaran"})}),t.jsx("button",{onClick:()=>N(d,`${p} sampai ${j}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Cabang"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Pembuat"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Gaji"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"ATK"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Sewa"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Intensif"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lisensi"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"THR"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:d.data.map((e,l)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.cabang?e.cabang.nama:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.gurus&&Array.isArray(e.gurus)&&e.gurus.length>0?e.gurus.map(i=>t.jsxs("div",{children:[i.guru_nama," - Rp ",r(i.gaji).toLocaleString()]},i.id)):"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(e.atk)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(e.sewa)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(e.intensif)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(e.lisensi)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(e.thr)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(e.lainlain)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(e.totalpengeluaran)}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(h,{href:`/admin/laporan/pengeluaran/${e.id}/edit`,children:t.jsx(A,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(h,{href:`/admin/laporan/pengeluaran/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:i=>{confirm("Are you sure you want to delete this item?")||i.preventDefault()},children:t.jsx(v,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},l))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{colSpan:"4",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(s("gaji"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(s("atk"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(s("sewa"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(s("intensif"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(s("lisensi"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(s("thr"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(s("lainlain"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:x(s("totalpengeluaran"))}),t.jsx("td",{className:"py-4 px-4"})]})})]})}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>k(f),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>k(y),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})};export{G as default};
