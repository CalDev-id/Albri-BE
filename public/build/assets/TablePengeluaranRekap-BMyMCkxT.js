import{r as w,U as $,j as t,a as g}from"./app-CjOG9aAE.js";import{u,w as G}from"./xlsx-DjuO7_Ju.js";import{S as o}from"./sweetalert2.esm.all-5zhdP7Ax.js";import"./flowbite.min-Dyi2Wf9s.js";import{F as K,a as D}from"./index-D-Tugu_n.js";import{d as T}from"./index-BCBCUD0G.js";const z=({laporanPengeluaranCabang:d,bulan:f,tahun:j,nextMonth:S,nextYear:A,prevMonth:B,prevYear:C})=>{const[c,m]=w.useState([]),[h,k]=w.useState(!1),r=e=>typeof e=="number"?e:parseInt(e,10)||0,l=e=>r(e).toLocaleString(),y=(e,x)=>{T.Inertia.get(route("admin.rekap.cabang"),{bulan:e,tahun:x})},i=e=>d.data.reduce((x,a)=>e==="gaji"?a.gurus&&Array.isArray(a.gurus)&&a.gurus.length>0?x+a.gurus.reduce((n,p)=>n+r(p.gaji),0):x+r(a.gaji):x+r(a[e]),0),v=(e,x)=>{const a=e.data.map(s=>{let b=0;return s.gurus&&Array.isArray(s.gurus)&&s.gurus.length>0?b=s.gurus.reduce((R,E)=>R+r(E.gaji),0):b=r(s.gaji),{Hari:s.hari||"",Tanggal:s.tanggal||"",Cabang:s.cabang?s.cabang.nama:"N/A","Nama Guru":s.user?s.user.name:"N/A",Gaji:b,ATK:r(s.atk),Sewa:r(s.sewa),Intensif:r(s.intensif),Lisensi:r(s.lisensi),THR:r(s.thr),"Lain Lain":r(s.lainlain),Total:r(s.totalpengeluaran)}}),n={Hari:"Total",Tanggal:"",Cabang:"","Nama Guru":"",Gaji:i("gaji"),ATK:i("atk"),Sewa:i("sewa"),Intensif:i("intensif"),Lisensi:i("lisensi"),THR:i("thr"),"Lain Lain":i("lainlain"),Total:i("totalpengeluaran")};a.push(n);const p=u.json_to_sheet(a),N=u.book_new();u.book_append_sheet(N,p,"Pengeluaran");const _=`Rekap_Pengeluaran_cabang_${x}.xlsx`;G(N,_)},H=e=>{m(x=>x.includes(e)?x.filter(a=>a!==e):[...x,e])},L=()=>{m(h?[]:d.data.map(e=>e.id)),k(!h)},I=()=>{if(c.length===0){o.fire({icon:"warning",title:"Pilih Data",text:"Pilih item yang ingin dihapus terlebih dahulu",confirmButtonColor:"#3085d6"});return}o.fire({title:"Konfirmasi Hapus",text:`Yakin ingin menghapus ${c.length} item yang dipilih?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"}).then(e=>{if(e.isConfirmed){const x=c.length;T.Inertia.post("/admin/laporan/pengeluaran/bulk-delete",{ids:c},{preserveScroll:!0,onStart:()=>{m([]),k(!1)},onSuccess:()=>{o.fire({icon:"success",title:"Berhasil!",text:`${x} item berhasil dihapus`,confirmButtonColor:"#3085d6",timer:2e3,timerProgressBar:!0})},onError:()=>{o.fire({icon:"error",title:"Gagal!",text:"Terjadi kesalahan saat menghapus data",confirmButtonColor:"#3085d6"})}})}})};return $.useEffect(()=>{d.data.length>0&&k(c.length===d.data.length)},[c,d.data]),t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark mt-20",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsxs("h4",{className:"text-xl font-semibold text-black dark:text-white",children:["Rekap Pengeluaran Cabang - ",f," ",j]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>v(d,`${f} / ${j}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"}),c.length>0&&t.jsxs("button",{onClick:I,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:["Hapus Terpilih (",c.length,")"]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-center",children:t.jsx("input",{type:"checkbox",checked:h,onChange:L,className:"checkbox checkbox-sm"})}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Cabang"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Pembuat"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Gaji"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"ATK"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Sewa"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Intensif"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lisensi"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"THR"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"}),t.jsx("th",{className:"py-4 px-4 text-center text-sm font-medium text-black dark:text-white",children:"Actions"})]})}),t.jsx("tbody",{children:d.data.map((e,x)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsx("input",{type:"checkbox",checked:c.includes(e.id),onChange:()=>H(e.id),className:"checkbox checkbox-sm"})}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:e.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.tanggal}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.cabang?e.cabang.nama:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.user?e.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:e.gurus&&Array.isArray(e.gurus)&&e.gurus.length>0?e.gurus.map(a=>t.jsxs("div",{children:[a.guru_nama," - Rp ",r(a.gaji).toLocaleString()]},a.id)):"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(e.atk)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(e.sewa)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(e.intensif)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(e.lisensi)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(e.thr)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(e.lainlain)}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(e.totalpengeluaran)}),t.jsx("td",{className:"py-4 px-4 text-center",children:t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(g,{href:`/admin/laporan/pengeluaran/${e.id}/edit`,children:t.jsx(K,{className:"text-yellow-500 hover:text-yellow-700 cursor-pointer"})}),t.jsx(g,{href:`/admin/laporan/pengeluaran/${e.id}`,method:"delete",as:"button",data:{id:e.id},onClick:a=>{o.fire({title:"Konfirmasi Hapus",text:"Yakin hapus item ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed||a.preventDefault()})},children:t.jsx(D,{className:"text-red-500 hover:text-red-700 cursor-pointer"})})]})})]},x))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{className:"py-4 px-4"})," ",t.jsx("td",{colSpan:"4",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(i("gaji"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(i("atk"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(i("sewa"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(i("intensif"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(i("lisensi"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(i("thr"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(i("lainlain"))}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l(i("totalpengeluaran"))}),t.jsx("td",{className:"py-4 px-4"})]})})]})}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>y(B,C),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>y(S,A),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})};export{z as default};
